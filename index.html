function doPost(e) {
  try {
    var data = JSON.parse(e.postData.contents);
    
    // 1. Decode the PDF data
    var decodedPdf = Utilities.base64Decode(data.pdfData);
    var blob = Utilities.newBlob(decodedPdf, 'application/pdf', data.filename);
    
    // 2. Target your DeliverySlip folder
    var folderId = "1HKgPJrRiRVUTMdmVWazY31p_FqLZBiiJ"; 
    var folder = DriveApp.getFolderById(folderId);
    
    // 3. Save the file
    var file = folder.createFile(blob);
    
    // 4. Record the delivery in the first tab of your Google Sheet
    var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheets()[0];
    sheet.appendRow([new Date(), data.customer, data.status, "PDF Saved", file.getUrl()]);
    
    return ContentService.createTextOutput("Success")
      .setMimeType(ContentService.MimeType.TEXT);
      
  } catch (err) {
    return ContentService.createTextOutput("Error: " + err.toString())
      .setMimeType(ContentService.MimeType.TEXT);
  }
}
